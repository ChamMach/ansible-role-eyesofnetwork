---
# task api_add_host

- name: use eonapi to create host
  uri:
    url: "{{eon_api_url}}/createHost?username={{eon_api_user}}&apiKey={{eon_api_token}}"
    method: POST
    headers:
      Content-Type: "application/json"
    body: '{ "hostName" : "{{ hostName }}", "hostIp" : "{{ hostIp }}", "hostAlias" : "{{ hostAlias }}", "templateHostName" : "{{ templateHostName }}" }'
    body_format: json
    return_content: yes
    validate_certs: no
  register: return

- name : display result
  debug:
    msg: "{{ return.content }}"
    
- name: Fail if ERROR in the page content
  fail:
  when: "'ERROR' in return.content"